<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»‡ Thá»‘ng GiÃ¡m SÃ¡t IoT V5.1 + AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ¡ï¸ Há»‡ Thá»‘ng GiÃ¡m SÃ¡t MÃ´i TrÆ°á»ng IoT V5.1 + AI</h1>
            <div class="status-bar">
                <span id="connection-status" class="status-badge disconnected">Máº¥t káº¿t ná»‘i</span>
                <span id="alert-badge" class="status-badge">OK</span>
                <span id="fan-status" class="status-badge">Quáº¡t: Táº®T ğŸ”´</span>
                <span id="timestamp">--:--:--</span>
            </div>
        </header>

        <!-- Tháº» cáº£m biáº¿n -->
        <div class="cards-grid">
            <div class="card">
                <div class="card-icon">ğŸŒ¡ï¸</div>
                <div class="card-content">
                    <h3>Nhiá»‡t Ä‘á»™</h3>
                    <div class="card-value" id="temp-value">--Â°C</div>
                    <div class="card-status" id="temp-status">BÃ¬nh thÆ°á»ng</div>
                </div>
            </div>

            <div class="card">
                <div class="card-icon">ğŸ’§</div>
                <div class="card-content">
                    <h3>Äá»™ áº©m</h3>
                    <div class="card-value" id="humid-value">--%</div>
                    <div class="card-status" id="humid-status">BÃ¬nh thÆ°á»ng</div>
                </div>
            </div>

            <div class="card">
                <div class="card-icon">ğŸ’¡</div>
                <div class="card-content">
                    <h3>Ãnh sÃ¡ng</h3>
                    <div class="card-value" id="light-value">-- Lux</div>
                    <div class="card-status" id="light-status">BÃ¬nh thÆ°á»ng</div>
                </div>
            </div>

            <div class="card">
                <div class="card-icon">â˜ï¸</div>
                <div class="card-content">
                    <h3>KhÃ­ gas</h3>
                    <div class="card-value" id="gas-value">-- PPM</div>
                    <div class="card-status" id="gas-status">An toÃ n</div>
                </div>
            </div>

            <div class="card">
                <div class="card-icon">ğŸ”¥</div>
                <div class="card-content">
                    <h3>Chá»‰ sá»‘ nhiá»‡t</h3>
                    <div class="card-value" id="heat-value">--Â°C</div>
                    <div class="card-status">Cáº£m giÃ¡c nhÆ°</div>
                </div>
            </div>

            <div class="card">
                <div class="card-icon">ğŸ˜Š</div>
                <div class="card-content">
                    <h3>Chá»‰ sá»‘ thoáº£i mÃ¡i</h3>
                    <div class="card-value" id="comfort-value">--/100</div>
                    <div class="card-status" id="comfort-status">--</div>
                </div>
            </div>
        </div>

        <!-- Panel AI Má»šI -->
        <div class="ai-panel">
            <div class="ai-header">
                <h2>ğŸ¤– PhÃ¢n TÃ­ch AI</h2>
                <div class="ai-controls">
                    <button id="btn-ai-now" class="btn btn-ai">PhÃ¢n tÃ­ch ngay</button>
                    <button id="btn-ai-settings" class="btn btn-settings">âš™ï¸ CÃ i Ä‘áº·t</button>
                </div>
            </div>
            
            <div id="ai-content" class="ai-content">
                <div class="ai-placeholder">
                    <span class="ai-icon">ğŸ¤–</span>
                    <p>Nháº¥n "PhÃ¢n tÃ­ch ngay" Ä‘á»ƒ xem Ä‘Ã¡nh giÃ¡ AI vá» mÃ´i trÆ°á»ng</p>
                </div>
            </div>
            
            <div id="ai-timestamp" class="ai-timestamp"></div>
        </div>

        <!-- Modal cÃ i Ä‘áº·t AI -->
        <div id="ai-settings-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>âš™ï¸ CÃ i Ä‘áº·t PhÃ¢n TÃ­ch AI</h2>
                
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="ai-enabled" checked>
                        Báº­t phÃ¢n tÃ­ch AI tá»± Ä‘á»™ng
                    </label>
                </div>
                
                <div class="setting-group">
                    <label for="ai-interval">Chu ká»³ phÃ¢n tÃ­ch (phÃºt):</label>
                    <input type="number" id="ai-interval" min="10" max="120" value="30">
                    <small>Tá»‘i thiá»ƒu: 10 phÃºt, Tá»‘i Ä‘a: 120 phÃºt</small>
                </div>
                
                <button id="btn-save-ai-settings" class="btn btn-primary">ğŸ’¾ LÆ°u cÃ i Ä‘áº·t</button>
            </div>
        </div>

        <!-- Biá»ƒu Ä‘á»“ -->
        <div class="charts-section">
            <h2>ğŸ“ˆ Biá»ƒu Ä‘á»“ thá»i gian thá»±c</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <canvas id="tempChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="humidChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ThÃ´ng tin há»‡ thá»‘ng -->
        <div class="info-panel">
            <h3>â„¹ï¸ ThÃ´ng tin há»‡ thá»‘ng</h3>
            <ul>
                <li>ğŸ¤– <strong>AI Gemini:</strong> PhÃ¢n tÃ­ch thÃ´ng minh mÃ´i trÆ°á»ng vá»›i Google Gemini Pro</li>
                <li>ğŸŒ€ <strong>Quáº¡t tá»± Ä‘á»™ng:</strong> Báº¬T khi nhiá»‡t Ä‘á»™ â‰¥ 30Â°C, Táº®T khi nhiá»‡t Ä‘á»™ â‰¤ 28Â°C</li>
                <li>ğŸ“Š <strong>Äá»‹nh dáº¡ng dá»¯ liá»‡u:</strong> Nhiá»‡t Ä‘á»™ (Â°C), Äá»™ áº©m (%), Ãnh sÃ¡ng (Lux), KhÃ­ gas (PPM)</li>
                <li>ğŸ”„ <strong>Cáº­p nháº­t cáº£m biáº¿n:</strong> Má»—i 2 giÃ¢y</li>
                <li>â˜ï¸ <strong>ThingSpeak:</strong> Má»—i 20 giÃ¢y</li>
                <li>ğŸ“¡ <strong>MQTT:</strong> Má»—i 5 giÃ¢y</li>
                <li>ğŸ’¡ <strong>ÄÃ¨n LED:</strong> Xanh=An toÃ n, Äá»=Cáº£nh bÃ¡o</li>
                <li>ğŸ”Š <strong>CÃ²i bÃ¡o:</strong> KÃªu khi cÃ³ cáº£nh bÃ¡o</li>
            </ul>
        </div>

        <!-- NgÆ°á»¡ng cáº£nh bÃ¡o -->
        <div class="info-panel">
            <h3>âš ï¸ NgÆ°á»¡ng cáº£nh bÃ¡o</h3>
            <ul>
                <li>ğŸŒ¡ï¸ <strong>Nhiá»‡t Ä‘á»™:</strong> 15-35Â°C (Quáº¡t: trá»… 28-30Â°C)</li>
                <li>ğŸ’§ <strong>Äá»™ áº©m:</strong> 30-80%</li>
                <li>ğŸ’¡ <strong>Ãnh sÃ¡ng:</strong> &gt; 200 Lux</li>
                <li>â˜ï¸ <strong>KhÃ­ gas:</strong> &lt; 300 PPM</li>
                <li>ğŸ˜Š <strong>Thoáº£i mÃ¡i:</strong> 0-60 (KÃ©m), 60-80 (Tá»‘t), 80-100 (Tuyá»‡t vá»i)</li>
            </ul>
        </div>

        <!-- TÃ­nh nÄƒng -->
        <div class="info-panel">
            <h3>âœ¨ TÃ­nh nÄƒng chÃ­nh</h3>
            <ul>
                <li>ğŸ¤– <strong>AI Gemini:</strong> PhÃ¢n tÃ­ch vÃ  Ä‘Ã¡nh giÃ¡ mÃ´i trÆ°á»ng tá»± Ä‘á»™ng</li>
                <li>ğŸ¯ <strong>Chá»‰ sá»‘ thoáº£i mÃ¡i:</strong> TÃ­nh toÃ¡n tá»« nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, Ã¡nh sÃ¡ng, má»©c khÃ­ gas</li>
                <li>ğŸ”¥ <strong>Chá»‰ sá»‘ nhiá»‡t:</strong> Nhiá»‡t Ä‘á»™ "cáº£m giÃ¡c nhÆ°" thá»±c táº¿</li>
                <li>ğŸŒ€ <strong>Quáº¡t thÃ´ng minh:</strong> Äiá»u khiá»ƒn tá»± Ä‘á»™ng dá»±a trÃªn nhiá»‡t Ä‘á»™ cÃ³ cháº¿ Ä‘á»™ trá»…</li>
                <li>ğŸ“± <strong>Bot Telegram:</strong> GiÃ¡m sÃ¡t & cáº£nh bÃ¡o tá»« xa vá»›i AI</li>
            </ul>
        </div>

        <!-- VÃ¹ng chá»©a thÃ´ng bÃ¡o -->
        <div id="alerts-container"></div>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>